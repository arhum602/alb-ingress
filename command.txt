aws ecr create-repository --repository-name dashboard
aws ecr create-repository --repository-name payment


eksctl create cluster --name eksdemo --node-type t2.small --nodes 3 --nodes-min 3 --nodes-max 5 --region ap-south-1


eksctl utils associate-iam-oidc-provider --region ap-south-1 --cluster eksdemo --approve


curl -o iam_policy.json https://raw.githubusercontent.com/kubernetes-sigs/aws-load-balancer-controller/v2.4.1/docs/install/iam_policy.json


eksctl create iamserviceaccount \
  --cluster=eksdemo \
  --namespace=kube-system \
  --name=aws-load-balancer-controller \
  --role-name "AmazonEKSLoadBalancerControllerRole" \
  --attach-policy-arn=arn:aws:iam::573692293734:policy/AWSLoadBalancerControllerIAMPolicy \
  --approve



kubectl annotate serviceaccount -n kube-system aws-load-balancer-controller \
    eks.amazonaws.com/sts-regional-endpoints=true  


kubectl apply -k github.com/aws/eks-charts/stable/aws-load-balancer-controller/crds?ref=master
kubectl get crd    




helm upgrade -i aws-load-balancer-controller eks/aws-load-balancer-controller -n kube-system --set clusterName=eksdemo --set serviceAccount.create=false --set serviceAccount.name=aws-load-balancer-controller --set image.tag="v2.4.1"


kubectl -n kube-system rollout status deployment aws-load-balancer-controller